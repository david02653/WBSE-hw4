<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pharmacy Search</title>
</head>
<style>
    body {
        background-color:darkgrey;
    }
    .header {
        text-align: center;
        background-color: goldenrod;
        color: white;
        font-size: 20px;
        padding: 5px;
    }
    .container {
        display: flex;
        flex-direction: column;
    }
    .item {
        flex-grow: 1;
        flex-shrink: 1;
    }
    .field {
        background-color:darkgray;
        text-align: center;
        flex-direction: row;
        display: flex;
        padding-top: 10px;
    }
    .disp {
        background-color:seagreen;
        flex-grow: 6;
        flex-shrink: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .panel {
        background-color: violet;
        flex-direction: column;
        display: flex;
        flex-grow: 4;
        padding-left: 5px;
        height: 40%;
    }
    .srh {
        background-color: aquamarine;
        flex-grow: 4;
        flex-shrink: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .inp {
        background-color:crimson;
        flex-grow: 6;
        flex-shrink: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    tr {
        margin: 7px;
        width: 100%;
        text-align: left;
        border: 1px solid black;
        border-collapse: collapse;
    }
    td {
        border: 1px solid black;
        border-collapse: collapse;
        width: 50%;
    }
    table {
        padding: 7px;
        border: 1px solid black;
        border-collapse: collapse;
    }
    input {
        margin: 4px;
    }
</style>
<body>
    <div class="container">
        <div class="header">
            <h2>Mask Search</h2>
            <p>help you to locate which pharmacy got masks</p>
        </div>
        <div class="field">
            <div class="disp" id="displayTable">
                <table>
                    <tr>
                        <td colspan="2" style="text-align: center">
                            data table
                        </td>
                    </tr>
                    <tr>
                        <td>id</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>address</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>phone</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>numberOfAdultMasks</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>numberOfChildrenMasks</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>updataTime</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>note</td>
                        <td></td>
                    </tr>
                </table>
            </div>

            <div class="panel">
                <div class="srh">
                    Pharmacy name:
                    <input type="text" id="pharmacyName" value="" placeholder="Input pharmacy name component">
                    Address:
                    <input type="text" id="address" value="" placeholder="Input pharmacy address component">
                    Pharmacy Id:
                    <input type="text" id="pharmacyId" value="" placeholder="Input pharmacy id">
                </div>
                <div class="inp">
                    Input Your Note:
                    <input type="text" id="noteArea" value="" placeholder="Write your note here">
                    <input id="search" type="button" value="Search By name/address/id">
                    <input id="addNote" type="button" value="Add Note to pharmacy">
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    let urlBase = "http://localhost:8888/pharmacy";
    let myUrl = urlBase + `?pharmacyName=`
                         + `${document.getElementById("pharmacyName").value}`
                         + `&zone=`
                         + `${document.getElementById("address").value}`;
    
    function getUrl(){
        return urlBase + `?pharmacyName=`
                         + `${document.getElementById("pharmacyName").value}`
                         + `&zone=`
                         + `${document.getElementById("address").value}`;
    }

    //let getUrl = urlBase + `?pharmacyName=` + pharmacyKey + `&zone=` + zone;
    function getAllData() {
        console.log(getUrl());
        //console.log(`${document.getElementById("address").value}`)

        
        fetch(getUrl(), {method: 'GET', headers: {
            'Content-Type': 'application/json'
        }})
        .then(function(res){
            return res.json();
        }).then(function(res){
            console.log(res);
            let place = document.getElementById("displayTable");
            place.innerHTML = "";
            for(var obj in res){
                console.log(obj); // json object count
                //console.table(res[obj]); // each json object
                place.innerHTML += `<table>
                <tr>
                    <td colspan="2" style="text-align: center">
                        ` + res[obj].id + `
                    </td>
                </tr>
                <tr>
                    <td>id</td>
                    <td>` + res[obj].id + `</td>
                </tr>
                <tr>
                    <td>name</td>
                    <td>` + res[obj].name + `</td>
                </tr>
                <tr>
                    <td>address</td>
                    <td>` + res[obj].address + `</td>
                </tr>
                <tr>
                    <td>phone</td>
                    <td>` + res[obj].phone + `</td>
                </tr>
                <tr>
                    <td>numberOfAdultMasks</td>
                    <td>` + res[obj].numberOfAdultMasks + `</td>
                </tr>
                <tr>
                    <td>numberOfChildrenMasks</td>
                    <td>` + res[obj].numberOfChildrenMasks + `</td>
                </tr>
                <tr>
                    <td>updataTime</td>
                    <td>` + res[obj].updatedTime + `</td>
                </tr>
                <tr>
                    <td>note</td>
                    <td>` + res[obj].note + `</td>
                </tr>
            </table>`;
            }
        })
        
        
    }
    document.getElementById("search").addEventListener("click", getAllData);
</script>
</html>